<h1>This is working now!</h1>

<div id="contacts-master" data-apiToken=<%=@api_token%>>
  <% @response['data'].map do |contact| %>
    <div class="contact" data-uuid=<%= contact['id'] %>>
      <div class="contact-line"> <%= contact['first_name'] %> <%= contact['last_name'] %> </div>
      <button class="contact-button">Send SMS</button>
    </div>
  <% end %>
<div>

<script>

  let contact;

  $(document).ready(function() {
    let envApiToken = document.getElementById("contacts-master").getAttribute("data-apiToken");
    $(".contact-button").click(function(e) {
      e.preventDefault();
      contact = this.parentNode;
      console.log(contact);
      console.log(contact.getAttribute("data-uuid"));
      console.log(envApiToken);
      $.ajax({
        method: "POST",
        url: window.location.href + "contacts",
        data: {
          "id": contact.getAttribute("data-uuid")
        },
        success: function(data) {
          console.log(data);
        },
        error: function(xhr, error) {
          console.log(xhr);
        }
      })
    });

  });

</script>
